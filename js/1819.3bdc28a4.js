"use strict";(self["webpackChunkvue3_test"]=self["webpackChunkvue3_test"]||[]).push([[1819,6770],{66770:function(t,e,s){s.r(e),s.d(e,{default:function(){return c}});var a=function(){var t=this;t._self._c;return t._m(0)},i=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"no-data-box"},[e("span",{staticClass:"no_wrap"},[e("span",{staticClass:"no_data"},[e("img",{attrs:{src:s(89728)}}),e("p",{staticClass:"no_data_text"},[t._v("暂无数据")])])])])}],n={},r=n,o=s(1001),l=(0,o.Z)(r,a,i,!1,null,"7953425b",null),c=l.exports},91819:function(t,e,s){s.r(e),s.d(e,{default:function(){return m}});var a=function(){var t=this,e=t._self._c;return e("section",{staticClass:"page notification"},[e("div",{staticClass:"header-wrap"},[e("div",{staticClass:"menu-bar"},[e("el-dropdown",{attrs:{size:"medium"},on:{command:t.switchSourceType}},[e("el-button",{staticClass:"menu-btn",attrs:{type:"text"}},[t._v(" "+t._s(t.currentSourceTypeText)),e("i",{staticClass:"el-icon-caret-bottom el-icon--right"})]),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{attrs:{command:"0"}},[t._v("全部消息")]),e("el-dropdown-item",{attrs:{command:"1"}},[t._v("系统消息")]),e("el-dropdown-item",{attrs:{command:"2"}},[t._v("机构消息")])],1)],1)],1),e("div",{staticClass:"search-bar"},[e("el-button",{staticClass:"all-readed-btn",on:{click:t.setAllReaded}},[t._v(" 全部标为已读 ")]),e("div",{staticClass:"custom-search"},[e("input",{directives:[{name:"model",rawName:"v-model.trim",value:t.searchParams.messageTitle,expression:"searchParams.messageTitle",modifiers:{trim:!0}}],staticClass:"custom-input",attrs:{type:"text",placeholder:"请输入"},domProps:{value:t.searchParams.messageTitle},on:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleSearch(t.searchParams.messageTitle)},input:function(e){e.target.composing||t.$set(t.searchParams,"messageTitle",e.target.value.trim())},blur:function(e){return t.$forceUpdate()}}}),e("el-button",{staticClass:"custom-button",attrs:{type:"primary",icon:"el-icon-search"},on:{click:function(e){return t.handleSearch(t.searchParams.messageTitle)}}},[t._v("搜索 ")])],1)],1)]),e("div",{staticClass:"list-wrap"},[t._l(t.dataList,(function(s,a){return e("div",{key:a,staticClass:"notice-wrap",on:{click:function(e){return t.dialogs(s)}}},[e("div",{staticClass:"title",class:["0"===s.status?"unread":""]},[t._v(" "+t._s(s.messageTitle)+" ")]),e("div",{staticClass:"content"},[t._v(t._s(t.delHtmlTag(s.messageContent)))]),e("div",{staticClass:"cell-row"},[e("div",{staticClass:"source"},[t._v(t._s(t._f("sourceText")(s.cpName||"系统")))]),e("div",{staticClass:"time"},[t._v(t._s(t._f("datetimeText")(s.createTime)))])])])})),t.isEmpty?e("div",[e("no-data")],1):t._e()],2),t.isEmpty?t._e():e("div",{staticClass:"pagination-box"},[e("el-pagination",{staticClass:"ou-pagination",attrs:{background:"","hide-on-single-page":"","current-page":t.searchParams.pageNum,"page-sizes":[10,15,20,25,30],"page-size":t.searchParams.pageSize,layout:"total, prev, pager, next, sizes, jumper, slot",total:t.total},on:{"size-change":t.changePageSize,"current-change":t.changePageCurrent}},[e("el-button",{staticClass:"ou-page-go",on:{click:t.getNotificationList}},[t._v("GO")])],1)],1),e("el-dialog",{attrs:{title:"消息详情",visible:t.dialogVisible,width:"50%","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{staticClass:"list-wrap listHeight"},[e("div",{staticClass:"notice-wrap"},[e("div",{staticClass:"title",class:["0"===t.dialogList.status?"unread":""]},[t._v(" "+t._s(t.dialogList.messageTitle)+" ")]),e("div",{staticClass:"content ql-editor ql-snow",domProps:{innerHTML:t._s(t.dialogList.messageContent)}}),e("div",{staticClass:"cell-row"},[e("div",{staticClass:"source"},[t._v(" "+t._s(t._f("sourceText")(t.dialogList.cpName||"系统"))+" ")]),e("div",{staticClass:"time"},[t._v(t._s(t._f("datetimeText")(t.dialogList.createTime)))])])])])])],1)},i=[],n=s(54526),r=s(99966),o=s(66770),l={name:"notification",components:{NoData:o["default"]},data(){return{dataList:[],searchParams:{pageNum:1,pageSize:10,messageTitle:"",isSystem:"0"},dialogVisible:!1,dialogList:"",total:0}},watch:{},computed:{...(0,n.Se)(["userId"]),currentSourceTypeText(){let t={0:"全部消息",1:"系统消息",2:"机构消息"};return t[this.searchParams.isSystem]},isEmpty(){return!this.dataList.length}},filters:{sourceText(t){return t?"来源："+t:""},datetimeText(t){if(!t)return"";let e=t.split("T")[0]||"",s=t.split("T")[1]||"";return e+" "+s.substr(0,8)}},activated(){this.getNotificationList()},mounted(){},methods:{selectInfo(t){(0,r.ml)({messageId:t}).then((t=>{200==t.code&&(this.dialogVisible=!0,this.getNotificationList())}))},dialogs(t){this.dialogList=t,this.selectInfo(t.messageId)},handleClose(t){t()},delHtmlTag(t){return t?(t=t.replace(/<img [^>]*src=['"]([^'"]+)[^>]*>/g,"<图片>"),t=t.replace(/<[^>]+>/g,""),t):"-"},getNotificationList(){let{pageNum:t,pageSize:e,messageTitle:s,isSystem:a}=this.searchParams,i={isSystem:a,pageSize:e,pageNum:t};i=s?{...i,messageTitle:s}:{...i,messageTitle:""},(0,r.Nb)(i).then((t=>{let e=t.rows||[];this.dataList=e,this.total=t.total||0}))},setAllReaded(){(0,r.pz)().then((t=>{this.getNotificationList()}))},handleSearch(){this.getNotificationList()},switchSourceType(t){this.searchParams.isSystem=t+"",this.getNotificationList()},changePageSize(t){this.searchParams.pageSize=t,this.getNotificationList()},changePageCurrent(t){this.searchParams.pageNum=t,this.getNotificationList()}}},c=l,d=s(1001),u=(0,d.Z)(c,a,i,!1,null,"f8669280",null),m=u.exports},89728:function(t,e,s){t.exports=s.p+"img/no_data.7d48eba9.png"}}]);
//# sourceMappingURL=1819.3bdc28a4.js.map